{% extends "base.html" %}
{% load staticfiles %}

{% block css %}
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link href="{% static 'css/admin.css' %}" rel="stylesheet" type="text/css"/>
    <style type="text/css">
        /* Base */
        body {
            font-size: 14px;
            margin: 0px;
            overflow-x: hidden;
        }

        .visit_total {
            font-size: 15px;
        }

        .visit_total .title {
            font-size: 15px;
            margin-bottom: 4px;
        }

        .visit_total .number {
            font-size: 20px;
        }

        .visit_total .chart {
            margin-top: 5px;
            height: 50px;
            width: 100px;
        }

        .bargauge {
            font-size: 15px;
        }

        .bargauge .title {
            padding: 16px;
        }

        .bargauge .chart {
            height: 150px;
            width: 80%;
        }

        .body {
            padding: 10px;
        }

        .dashed {
            border-top: 1px dashed #e5e5e5;

        }
    </style>
{% endblock %}

{% block content %}
    <div class="header">
        <div class="logo">
            <i class="icon-menu"></i>
        </div>
        <div class="toolbar">

            <span>{% block title %}{{ group.name }}{% endblock %}</span>

    <span>
          <select id="dynamic_select">
              {% for grp in groups %}
                  <option id="{{ grp.id }}" value="{% url 'archive:group' grp.id %}"
                          {% if group.id == grp.id %}selected="selected"{% endif %}>{{ grp.name }}</option>
              {% endfor %}
          </select>
    </span>
    <span style="float:right">
      Sample <i class="icon-check"></i>
    </span>

        </div>
    </div>
    <div class="container">
        <div class="menu">

            <div class="vmenu ">
                <a class="active"><i class="icon-monitoring"></i> Dashboard</a>
                <a href="realtime.html"><i class="icon-realtime"></i> Realtime</a>
                <a href="analysis.html"><i class="icon-profile"></i> Analysis</a>
                <a><i class="icon-chart"></i> Statistics</a>
                <a><i class="icon-document"></i> Document</a>
                <a><i class="icon-gear"></i> Management</a>
                <a><i class="icon-user"></i> User</a>
            </div>

        </div>
        <div class="content">

            <div class="content-list">
                <div class="dashboard-first">
                    <div class="col col-3">
                        <div class="card">
                            <div class="title">Total Posts</div>
                            <div class="value">{{ group.post_count }}</div>
                        </div>
                    </div>
                    <div class="col col-3">
                        <div class="card">
                            <div class="title">Total Comments</div>
                            <div class="value">{{ group.comment_count }}</div>
                        </div>

                    </div>
                    <div class="col col-3">
                        <div class="card">
                            <div class="title">Weekly Posts</div>
                            <div class="value">{{ posts|length }}</div>
                        </div>

                    </div>
                    <div class="col col-3">
                        <div class="card">
                            <div class="title">Last Updated</div>
                            <div class="value">{{ group.get_diff_time }}</div>
                        </div>

                    </div>
                </div>

                <div class="panel">
                    <div class="body">
                        <h2 class="title">Analysis</h2>

                        <ul id="tab_1" class="tab top">
                            <li>
                                <a href="#home">Home</a>
                            </li>
                            <li><a href="#css">CSS</a></li>
                            <li><a href="#script">Script</a></li>
                        </ul>

                        <div id="tab_contents_1">
                            <div id="home">home</div>
                            <div id="css">css</div>
                            <div id="script">script</div>
                        </div>
                    </div>
                </div>

                <div class="panel dashed">

                    <div class="body">
                        <h2 class="title">Analysis</h2>

                        <div class="view">
                            <div id="traffic_chart" style="height:400px;"></div>
                        </div>

                    </div>

                </div>

                <div class="panel dashed">
                    <div class="body">
                        <h2 class="title">Analysis</h2>

                        <div class="row view" style="height:150px;">
                            <div class="col col-7">
                                <div id="visit_chart" style="height:100%;"></div>
                            </div>
                            <div class="col col-5">
                                <div id="gauge_chart" style="height:100%;"></div>
                            </div>
                        </div>
                        <div class="row view" style="margin-top:10px;border-top:1px dashed #dedede;">
                            <div class="col col-7">
                                <div style="font-weight: bold;margin-top:10px;margin-bottom:10px;"><strong
                                        style="font-size:25px;font-weight:bold;color:#255bff;">1,452,587</strong> people
                                    visited this site
                                </div>
                                <div style="border:1px solid #b5defd;padding:20px;padding-left:40px;">
                                    <div class="row visit_total">
                                        <div class="col col-4">
                                            <div class="title">Visits</div>
                                            <div class="number"><strong>3,352</strong></div>
                                            <div class="chart" id="line_sample_chart_1"></div>
                                        </div>
                                        <div class="col col-4">
                                            <div class="title">Unique Visitors</div>
                                            <div class="number"><strong>1,672</strong></div>
                                            <div class="chart" id="line_sample_chart_2"></div>
                                        </div>
                                        <div class="col col-4">
                                            <div class="title">Previews</div>
                                            <div class="number"><strong>6,048</strong></div>
                                            <div class="chart" id="line_sample_chart_3"></div>
                                        </div>
                                    </div>
                                    <div class="row visit_total">
                                        <div class="col col-4">
                                            Pages per visit : <strong>1.78</strong>
                                        </div>
                                        <div class="col col-8">
                                            Average Visit Duration : <strong>00:01:12</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-5">
                                <div class="row bargauge">
                                    <div class="col col-6">
                                        <div class="title">Visits by Browser</div>
                                        <div class="chart" id="bar_gauge_sample_chart_1"></div>
                                    </div>
                                    <div class="col col-6">
                                        <div class="title">Mobile Overview</div>
                                        <div class="chart" id="bar_gauge_sample_chart_2"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel dashed">
                    <div class="body">
                        <h2 class="title">Analysis</h2>

                        <div class="view">

                            <div class="panel" style="border:1px solid #ababab;">
                                <div class="head">
                                    Recent Order List
                                </div>
                                <table class="table simple hover">
                                    <colgroup>
                                        <col style="width: 15%;">
                                        <col style="width: 10%;">
                                        <col style="width: 10%;">
                                        <col style="width: 40%;">
                                        <col style="width: 5%;">
                                        <col style="width: 5%;">
                                        <col style="width: 5%;">
                                        <col style="width: 10%;">
                                    </colgroup>
                                    <thead>
                                    <tr>
                                        <th>From</th>
                                        <th>Created Time</th>
                                        <th>Updated Time</th>
                                        <th>Message</th>
                                        <th>Like Count</th>
                                        <th>Comment Count</th>
                                        <th>Share Count</th>
                                        <th><a class="btn btn-base">All Orders</a></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for post in posts %}
                                        <tr>
                                            <td>
                                                <i class="icon-stop" style="font-size:8.5px;color:red;"></i>
                                                {{ post.user.name }}
                                            </td>
                                            <td>{{ post.get_diff_cre_time }}</td>
                                            <td>{{ post.get_diff_upe_time }}</td>
                                            <td>{{ post.message|truncatechars:80 }}</td>
                                            <td>{{ post.like_count }}</td>
                                            <td>{{ post.comment_count }}</td>
                                            <td>{{ post.share_count }}</td>
                                            <td><i class="icon-search"></i> View</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </div>


        </div>
    </div>
{% endblock %}

{% block script %}
    <script src="{% static 'js/admin.js' %}" type="text/javascript"></script>
    <script>
        var chart = jui.include("chart.builder");


        var dataSource = [
            {date: "Apr", value1: 36, value2: 42},
            {date: "May", value1: 30, value2: 24},
            {date: "Jun", value1: 20, value2: 28},
            {date: "Jul", value1: 41, value2: 36},
            {date: "Aug", value1: 26, value2: 34},
            {date: "Sept", value1: 21, value2: 28}
        ];

        var dataSource2 = [
            {mr: "MR 1", value1: 4470, value2: 3650},
            {mr: "MR 2", value1: 6300, value2: 4000},
            {mr: "MR 3", value1: 4590, value2: 5150},
            {mr: "MR 4", value1: 4500, value2: 5150},
            {mr: "MR 5", value1: 5550, value2: 3800},
            {mr: "MR 6", value1: 6500, value2: 6100},
            {mr: "MR 7", value1: 4775, value2: 6800},
            {mr: "MR 8", value1: 4950, value2: 4000},
            {mr: "MR 9", value1: 4400, value2: 4030},
            {mr: "MR 10", value1: 4100, value2: 3100},
            {mr: "MR 11", value1: 4800, value2: 2090},
            {mr: "MR 12", value1: 5100, value2: 4100}
        ];

        var chart_list = [];

        chart_list[chart_list.length] = chart("#traffic_chart", {
            padding: {left: 60, right: 80, top: 50, bottom: 30},
            axis: [
                {
                    x: {
                        domain: "date",
                        color: 0
                    },
                    y: {
                        type: "range",
                        domain: [0, 100],
                        step: 5,
                        color: 0
                    },
                    data: dataSource
                },
                {
                    x: {
                        domain: "mr",
                        color: 0,
                        orient: "top"
                    },
                    y: {
                        type: "range",
                        domain: [0, 8000],
                        step: 5,
                        color: 1,
                        orient: "right",
                        format: function (d) {
                            if (typeof(d) == "number")
                                return (d / 1000) + "K";

                            return d;
                        }
                    },
                    data: dataSource2
                }
            ],
            brush: [
                {
                    type: "column",
                    target: ["value1", "value2"],
                    colors: [0, 1],
                    innerPadding: -20,
                    outerPadding: 20
                },
                {
                    type: "line",
                    target: ["value1", "value2"],
                    axis: 1,
                    colors: [1, 2],
                    symbol: "curve"
                },
                {
                    type: "scatter",
                    target: ["value1", "value2"],
                    axis: 1,
                    colors: [1, 2]
                }
            ],
            widget: [
                {
                    type: "title",
                    text: "Marketing Report",
                    dy: -10
                },
                {
                    type: "title",
                    text: "Number of New Clients Acquired",
                    align: "start",
                    orient: "center",
                    dx: -115,
                    dy: -10
                },
                {
                    type: "title",
                    text: "Marketing Dollars Spent",
                    align: "end",
                    orient: "center",
                    dx: 115,
                    dy: -10
                },
                {
                    type: "tooltip",
                    format: function (k, v) {
                        return v;
                    },
                    brush: [0, 2]
                }
            ],
            style: {
                gridAxisBorderWidth: 2,
                titleFontSize: "11px",
                titleFontWeight: "bold"
            }
        });

        // column chart sample
        var data = [
            {quarter: "0", sales: 50},
            {quarter: "1", sales: 50},
            {quarter: "2", sales: 20},
            {quarter: "3", sales: 10},
            {quarter: "4", sales: 30},
            {quarter: "5", sales: 44},
            {quarter: "6", sales: 22},
            {quarter: "7", sales: 21},
            {quarter: "8", sales: 36},
            {quarter: "9", sales: 56},
            {quarter: "10", sales: 30},
            {quarter: "11", sales: 32},
            {quarter: "12", sales: 25},
            {quarter: "13", sales: 25},
            {quarter: "14", sales: 50},
            {quarter: "15", sales: 25},
            {quarter: "16", sales: 10},
            {quarter: "17", sales: 25},
            {quarter: "18", sales: 30},
            {quarter: "19", sales: 30},
            {quarter: "20", sales: 15},
            {quarter: "21", sales: 30},
            {quarter: "22", sales: 30},
            {quarter: "23", sales: 30},
            {quarter: "24", sales: 30},
            {quarter: "25", sales: 30},
            {quarter: "26", sales: 30},
            {quarter: "27", sales: 30},
            {quarter: "28", sales: 30},
            {quarter: "29", sales: 30},
            {quarter: "30", sales: 30},
            {quarter: "31", sales: 30},
            {quarter: "32", sales: 30},
            {quarter: "33", sales: 25},
            {quarter: "34", sales: 25},
            {quarter: "35", sales: 25},
            {quarter: "36", sales: 25}
        ];

        chart_list[chart_list.length] = chart("#visit_chart", {
            padding: 0,
            axis: {
                x: {
                    type: "block",
                    domain: "quarter",
                    line: true,
                    hide: true
                },
                y: {
                    type: "range",
                    domain: "sales",
                    step: 10,
                    line: true,
                    hide: true
                },
                data: data
            },
            brush: {
                type: "column",
                target: "sales",
                active: 5,
                colors: [0]
            },
            style: {
                barBorderRadius: 0
            }
        });

        // donut sample
        var dataSource2 = [
            {title: "Overall Visits", value: 192, max: 200, min: 0},
            {title: "New Visits", value: 66, max: 100, min: 0},
            {title: "Mobile Visits", value: 75, max: 100, min: 0}
        ];

        chart_list[chart_list.length] = chart("#gauge_chart", {
            padding: {left: 0, top: 10, right: 0, bottom: 20},
            axis: {
                c: {
                    type: "table",
                    rows: 1,
                    columns: 3
                },
                data: dataSource2
            },
            brush: {
                type: "fullgauge",
                size: 10,
                titleY: 70,
                format: function (value, index) {
                    if (index == 0) {
                        return value + "k";
                    }

                    return value + "%";
                }
            },
            style: {
                fontFamily: "Open Sans"
            }
        });

        // line sample chart 1
        var time = jui.include('util.time');

        var stocks = {
            apple: [50, 80.23, 81.23, 91.03, 90.77, 82.98, 79.35, 78.5, 79.34, 81.46, 73.7, 62.02, 55.03, 51.93, 55, 51.81, 52.29, 53.05, 45.61, 47.26, 47.57, 47.35, 47.99, 46.1, 43.83, 42.28, 40.89, 38.55, 33.03, 34.95, 34.18, 34.9, 35.47, 31.93, 27.8, 26.1].reverse(),
            microsoft: [25.39, 25.31, 26.91, 28.06, 29.06, 27.61, 28.66, 27.34, 29.8, 30.02, 29.54, 27.3, 24, 23.65, 24.44, 22.84, 24.41, 24.99, 23.71, 22.81, 23.48, 23, 24.08, 24.97, 25.14, 22.75, 23.87, 21.92, 21.01, 22.98, 20.49, 22.97, 27.07, 25.96, 25.41, 24.86].reverse(),
            oracle: [32.78, 31.48, 30.4, 30.71, 30.9, 29.48, 28.93, 25.79, 28.64, 28.35, 28.44, 27.43, 24.88, 30.41, 31.79, 27.82, 27.18, 29.61, 31.81, 33.07, 34.75, 32.25, 31.74, 30.9, 30.15, 26.05, 28.3, 25.81, 21, 22.73, 20.59, 21.65, 24.82, 24.62, 23.6, 22.08].reverse()
        };
        var start = new Date("2010/01/01"); // ~2012-12-31
        var end = new Date("2012/12/31");

        data = [];
        for (var i = 0; i < stocks.apple.length; i++) {
            data.push({
                date: time.add(start, time.months, i),
                apple: stocks.apple[i],
                microsoft: stocks.microsoft[i],
                oracle: stocks.oracle[i]
            });
        }

        chart_list[chart_list.length] = chart("#line_sample_chart_1", {
            padding: 0,
            axis: {
                x: {
                    type: "date",
                    domain: [start, end],
                    interval: 1000 * 60 * 24 * 365,
                    format: "yyyy",
                    key: "date",
                    hide: true
                },
                y: {
                    type: "range",
                    domain: "apple",
                    step: 10,
                    line: true,
                    hide: true
                },
                data: data
            },
            brush: {
                type: "line",
                target: ["apple"]
            }
        });

        chart_list[chart_list.length] = chart("#line_sample_chart_2", {
            padding: 0,
            axis: {
                x: {
                    type: "date",
                    domain: [start, end],
                    interval: 1000 * 60 * 24 * 365,
                    format: "yyyy",
                    key: "date",
                    hide: true
                },
                y: {
                    type: "range",
                    domain: "microsoft",
                    step: 10,
                    line: true,
                    hide: true
                },
                data: data
            },
            brush: {
                type: "line",
                target: ["microsoft"]
            }
        });

        chart_list[chart_list.length] = chart("#line_sample_chart_3", {
            padding: 0,
            axis: {
                x: {
                    type: "date",
                    domain: [start, end],
                    interval: 1000 * 60 * 24 * 365,
                    format: "yyyy",
                    key: "date",
                    hide: true
                },
                y: {
                    type: "range",
                    domain: "oracle",
                    step: 10,
                    line: true,
                    hide: true
                },
                data: data
            },
            brush: {
                type: "line",
                target: ["oracle"]
            }
        });

        // bar gauge sample
        chart_list[chart_list.length] = chart("#bar_gauge_sample_chart_1", {
            padding: {left: 20, top: 0, bottom: 0, right: 0},
            axis: {
                data: [
                    {title: "Chrome", value: 54.1},
                    {title: "Firefox", value: 26.6},
                    {title: "Safari", value: 10.2},
                    {title: "Internet Explorer", value: 5.7},
                    {title: "Opera", value: 3}
                ]
            },
            brush: {
                type: "bargauge",
                size: 25,
                format: function (value) {
                    return value + '%';
                }
            }
        });

        // bar gauge sample
        chart_list[chart_list.length] = chart("#bar_gauge_sample_chart_2", {
            padding: {left: 20, top: 0, bottom: 0, right: 0},
            axis: {
                data: [
                    {title: "Desktop", value: 89},
                    {title: "Mobile", value: 6},
                    {title: "Tablet", value: 5}
                ]
            },
            brush: {
                type: "bargauge",
                size: 25,
                format: function (value) {
                    return value + "%";
                }
            }
        });

        /* Scheduled deletion

         function changeTheme(theme) {
         // change ui
         $("#jui_theme").attr("href", "../../../lib/jui.new/" + theme + ".theme.min.css");

         // change chart

         for(var i = 0, len = chart_list.length; i < len; i++) {

         if (chart_list[i].setTheme) {
         chart_list[i].setTheme(theme);
         } else {
         chart_list[i].chart.setTheme(theme);
         }

         }
         }
         */

        jui.ready(["uix.tab"], function (tab) {
            tab_1 = tab("#tab_1", {
                event: {
                    change: function (data) {
                        alert(data.text);
                    }
                },
                target: "#tab_contents_1",
                index: 0
            });
        });

{#        var dataSource3 = [#}
{#            {date: "J", profit1: 48000, profit2: 110},#}
{#            {date: "F", profit1: 31000, profit2: 58},#}
{#            {date: "M", profit1: 62000, profit2: 104},#}
{#            {date: "A", profit1: 40500, profit2: 357},#}
{#            {date: "M", profit1: 44550, profit2: 294},#}
{#            {date: "J", profit1: 29500, profit2: 367},#}
{#            {date: "J", profit1: 46000, profit2: 285},#}
{#            {date: "A", profit1: 70050, profit2: 340},#}
{#            {date: "S", profit1: 39500, profit2: 397},#}
{#            {date: "O", profit1: 45800, profit2: 425},#}
{#            {date: "N", profit1: 29000, profit2: 254},#}
{#            {date: "D", profit1: 15000, profit2: 187}#}
{#        ];#}

        var dataSource3 = {{ data_source|safe }}

        chart("#home", {
            padding: {
                left: 60
            },
            height: 400,
            axis: [{
                data: dataSource3,
                x: {
                    type: "block",
                    domain: "date"
                },
                y: {
                    type: "range",
                    domain: [0, 1000],
                    step: 4,
                    line: true
                },
                area: {
{#                    width: "100%",#}
{#                    height: "40%"#}
                }
            }, {
                x: {
                    hide: true
                },
                y: {
                    domain: [0, 500],
                    orient: "right"
                },
                area: {
{#                    width: "100%",#}
{#                    height: "40%"#}
                },
                extend: 0
            }],
            brush: [{
                type: "column",
                target: "profit1",
                axis: 0,
                colors: [0],
                animate: true
            }, {
                type: "line",
                target: "profit2",
                axis: 1,
                colors: [2],
                animate: true
            }, {
                type: "scatter",
                target: "profit2",
                size: 10,
                axis: 1,
                colors: [2]
            }],
            widget: [{
                type: "title",
                text: "Sales Overview",
                align: "start"
            }, {
                type: "title",
                text: "Net Profit",
                align: "start",
                orient: "center",
                dx: -55,
                dy: -90
            }, {
                type: "tooltip",
                format: function (k, v) {
                    return v;
                },
                brush: [0, 2, 3, 4]
            }],
            style: {
                scatterBorderWidth: 1.5,
                titleFontSize: "11px",
                titleFontWeight: "bold"
            },
            format: function (v) {
                if (typeof(v) == "number") {
                    return ((v > 1000) ? Math.floor(v / 1000) + "k" : v);
                }

                return v;
            }
        });

    </script>
{% endblock %}
